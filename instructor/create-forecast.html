<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="es" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Real-time analysis and forecasting for outbreak analytics with R: Crear una previsión a corto plazo</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/epiverse-trace/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicons/epiverse-trace/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicons/epiverse-trace/favicon-16x16.png"><link rel="manifest" href="../favicons/epiverse-trace/site.webmanifest"><link rel="mask-icon" href="../favicons/epiverse-trace/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav epiverse-trace"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Ir al contenido principal</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="epiverse-trace-logo" alt="epiverse-trace" src="../assets/images/epiverse-trace-logo.svg"><span class="badge text-bg-danger" style="background-color: #FF4955; border-radius: 5px">
          <abbr title="Esta lección se encuentra en la fase pre-alfa, lo que significa que está en las primeras etapas de desarrollo, pero aún no se ha enseñado.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alfa
            </a>
            <span class="visually-hidden">Esta lección se encuentra en la fase pre-alfa, lo que significa que está en las primeras etapas de desarrollo, pero aún no se ha enseñado.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Vista de la instructora <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../create-forecast.html';">Vista de estudiante</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav epiverse-trace" aria-label="Navegación principal"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Alternar navegación">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menú</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="epiverse-trace" src="../assets/images/epiverse-trace-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Real-time analysis and forecasting for outbreak analytics with R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Buscar en la página All In One" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Real-time analysis and forecasting for outbreak analytics with R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Puntos Clave</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Notas de la instructora</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extraer todas las imágenes</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            Más <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Buscar en la página All In One"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Buscar en la página All In One">Buscar en la página All In One</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Real-time analysis and forecasting for outbreak analytics with R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 40%" class="percentage">
    40%
  </div>
  <div class="progress epiverse-trace">
    <div class="progress-bar epiverse-trace" role="progressbar" style="width: 40%" aria-valuenow="40" aria-label="Progreso de la lección" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="Cerrar menú" alt="Cerrar menú" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Cerrar " data-episodes="Episodios ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Vista de la instructora
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../create-forecast.html">Vista de estudiante</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODIOS
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Resumen y agenda</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="delays-access.html">1. Acceder a las distribuciones de retrasos epidemiológicos</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="quantify-transmissibility.html">2. Cuantificar la transmisión</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="delays-functions.html">3. Utilizar distribuciones de retraso en el análisis</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        4. Crear una previsión a corto plazo
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#introducci%C3%B3n">Introducción</a></li>
<li><a href="#crear-una-previsi%C3%B3n-a-corto-plazo">Crear una previsión a corto plazo</a></li>
<li><a href="#previsi%C3%B3n-de-observaciones-secundarias">Previsión de observaciones secundarias</a></li>
<li><a href="#reto-an%C3%A1lisis-del-brote-de-%C3%A9bola">Reto: Análisis del brote de ébola</a></li>
<li><a href="#resumen">Resumen</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="severity-static.html">5. Estimación de la severidad del brote</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="superspreading-estimate.html">6. Account for superspreading</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="superspreading-simulate.html">7. Simulate transmission chains</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RECURSOS
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Puntos Clave</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Notas de la instructora</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extraer todas las imágenes</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="../instructor/aio.html">Todo en una sola página</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Capítulo previo y siguiente"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/delays-functions.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previo</a>
        <a class="chapter-link float-end" href="../instructor/severity-static.html">Siguiente<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/delays-functions.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previo: Utilizar
        </a>
        <a class="chapter-link float-end" href="../instructor/severity-static.html" rel="next">
          Siguiente: Estimación de la...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Crear una previsión a corto plazo</h1>
        <p>Última actualización: 2024-10-22 |

        <a href="https://github.com/epiverse-trace/tutorials-middle/edit/main/episodes/create-forecast.Rmd" class="external-link">Mejora esta página <i aria-hidden="true" data-feather="edit"></i></a></p>



        <p>Tiempo estimado: <i aria-hidden="true" data-feather="clock"></i> 60 minutos</p>

        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Mostrar todas las soluciones " data-collapse="Cerrar todas las soluciones "> Mostrar todas las soluciones <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Hoja de ruta</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Preguntas</h3>
<ul><li>¿Cómo puedo crear previsiones a corto plazo a partir de datos de
casos?</li>
<li>¿Cómo tengo en cuenta los informes incompletos en las
previsiones?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objetivos</h3>
<ul><li>Aprender a hacer previsiones de casos utilizando el paquete R
<code>EpiNow2</code>
</li>
<li>Aprende a incluir un proceso de observación en la estimación</li>
</ul></div>
</div>
</div>
</div>
</div>
<div id="requisitos-previos" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="requisitos-previos" class="callout-inner">
<h3 class="callout-title">Requisitos previos</h3>
<div class="callout-content">
<ul><li>Tutorial completo <a href="quantify-transmissibility.html">Cuantificar la
transmisión</a>
</li>
</ul><p>Los alumnos deben familiarizarse con las siguientes dependencias
conceptuales antes de trabajar en este tutorial:</p>
<p><strong>Estadísticas</strong> Distribuciones de probabilidad,
principio del análisis bayesiano.</p>
<p><strong>Teoría epidémica</strong> Número de reproducción
efectiva.</p>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introducción">Introducción<a class="anchor" aria-label="anchor" href="#introducci%C3%B3n"></a></h2>
<hr class="half-width"><p>Dados los datos de casos de una epidemia, podemos crear estimaciones
del número actual y futuro de casos teniendo en cuenta tanto los
retrasos en la notificación y la infranotificación. Para hacer
afirmaciones sobre el futuro de la epidemia, tenemos que hacer una
suposición sobre cómo las observaciones hasta el presente están
relacionadas con lo que esperamos que ocurra en el futuro. La forma más
sencilla de hacerlo es suponer que “no hay cambios”, es decir, que el
número de reproducciones sigue siendo el mismo en el futuro que el
último observado. En este tutorial crearemos <a href="reference.html#forecast">previsiones</a> suponiendo que el número
de reproducción seguirá siendo el mismo que el estimado en la última
fecha para la que se disponía de datos.</p>
<p>En este tutorial vamos a aprender a utilizar la función
<a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a> para prever los casos teniendo en cuenta las
observaciones incompletas y prever las observaciones secundarias, como
las defunciones.</p>
<p>Utilizaremos la tubería <code>%&gt;%</code> para conectar funciones,
así que vamos a llamar también a la función <a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a>
paquete:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">EpiNow2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div id="el-doble-punto" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div id="el-doble-punto" class="callout-inner">
<h3 class="callout-title">El doble punto</h3>
<div class="callout-content">
<p>El doble punto <code>::</code> en R te permite llamar a una función
específica de un paquete sin cargar todo el paquete en el entorno
actual.</p>
<p>Por ejemplo <code>dplyr::filter(data, condition)</code> utiliza
<code>filter()</code> del <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> paquete.</p>
<p>Esto nos ayuda a recordar las funciones del paquete y a evitar
conflictos de espacio de nombres.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="crear-una-previsión-a-corto-plazo">Crear una previsión a corto plazo<a class="anchor" aria-label="anchor" href="#crear-una-previsi%C3%B3n-a-corto-plazo"></a></h2>
<hr class="half-width"><p>La función <code>epinow()</code> descrita en el <a href="quantify-transmissibility.html">cuantificación de la
transmisión</a> es una envoltura de las funciones:</p>
<ul><li>
<code>estimate_infections()</code> utilizadas para estimar los casos
por fecha de infección.</li>
<li>
<code>forecast_infections()</code> Se utiliza para simular
infecciones utilizando un ajuste existente (estimación) a los casos
observados.</li>
</ul><p>Utilicemos el mismo código utilizado en <a href="quantify-transmissibility.html">cuantificar la transmisi</a> para
obtener los datos de entrada, los retardos y las priors:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read cases dataset</span></span>
<span><span class="va">cases</span> <span class="op">&lt;-</span> <span class="fu">incidence2</span><span class="fu">::</span><span class="va">covidregionaldataUK</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># use {tidyr} to preprocess missing values</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu">replace_na</span><span class="op">(</span><span class="fu">base</span><span class="fu">::</span><span class="fu">list</span><span class="op">(</span>cases_new <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># use {incidence2} to compute the daily incidence</span></span>
<span>  <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">incidence</span><span class="op">(</span></span>
<span>    date_index <span class="op">=</span> <span class="st">"date"</span>,</span>
<span>    counts <span class="op">=</span> <span class="st">"cases_new"</span>,</span>
<span>    count_values_to <span class="op">=</span> <span class="st">"confirm"</span>,</span>
<span>    date_names_to <span class="op">=</span> <span class="st">"date"</span>,</span>
<span>    complete_dates <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">count_variable</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Incubation period</span></span>
<span><span class="va">incubation_period_fixed</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">Gamma</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Log-tranformed mean</span></span>
<span><span class="va">log_mean</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">convert_to_logmean</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Log-transformed std</span></span>
<span><span class="va">log_sd</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">convert_to_logsd</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reporting dalay</span></span>
<span><span class="va">reporting_delay_fixed</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">LogNormal</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="va">log_mean</span>,</span>
<span>  sd <span class="op">=</span> <span class="va">log_sd</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generation time</span></span>
<span><span class="va">generation_time_fixed</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">LogNormal</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fl">3.6</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">3.1</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define Rt prior distribution</span></span>
<span><span class="va">rt_prior</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">rt_opts</span><span class="op">(</span>prior <span class="op">=</span> <span class="fu">base</span><span class="fu">::</span><span class="fu">list</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>Ahora podemos extraer la previsión a corto plazo utilizando:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assume we only have the first 90 days of this data</span></span>
<span><span class="va">reported_cases</span> <span class="op">&lt;-</span> <span class="va">cases</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">90</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimate and forecast</span></span>
<span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">epinow</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">reported_cases</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">generation_time_fixed</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">delay_opts</span><span class="op">(</span><span class="va">incubation_period_fixed</span> <span class="op">+</span> <span class="va">reporting_delay_fixed</span><span class="op">)</span>,</span>
<span>  rt <span class="op">=</span> <span class="va">rt_prior</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>WARN [2024-10-22 02:41:48] epinow: There were 1 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them. -
WARN [2024-10-22 02:41:48] epinow: Examine the pairs() plot to diagnose sampling problems
 -
WARN [2024-10-22 02:41:49] epinow: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.
Running the chains for more iterations may help. See
https://mc-stan.org/misc/warnings.html#bulk-ess - </code></pre>
</div>
<div id="no-esperes-a-que-se-complete" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="no-esperes-a-que-se-complete" class="callout-inner">
<h3 class="callout-title">¡No esperes a que se complete!</h3>
<div class="callout-content">
<p>Esta última parte puede tardar 10 minutos en ejecutarse. Sigue
leyendo este episodio del tutorial mientras esto se ejecuta en segundo
plano. Para más información sobre el tiempo de computación, lee la
sección “Inferencia Bayesiana con Stan” dentro del tutorial <a href="quantify-transmissibility.html">cuantificar la transmisi</a> de la
transmisión.</p>
</div>
</div>
</div>
<p>Podemos visualizar las estimaciones del número de reproducciones
efectivas y del número estimado de casos utilizando <code>plot()</code>.
Las estimaciones se dividen en tres categorías:</p>
<ul><li><p><strong>Estimación</strong> (verde): utiliza todos los
datos,</p></li>
<li><p><strong>Estimación basada en datos parciales</strong> (naranja):
contiene un mayor grado de incertidumbre porque dichas estimaciones se
basan en menos datos,</p></li>
<li><p><strong>Previsión</strong> (morado): previsiones hacia el
futuro.</p></li>
</ul><div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/create-forecast-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="section level3">
<h3 id="previsión-con-observaciones-incompletas">Previsión con observaciones incompletas<a class="anchor" aria-label="anchor" href="#previsi%C3%B3n-con-observaciones-incompletas"></a></h3>
<p>En la <a href="quantify-transmissibility.html">cuantificación de la
transmisión</a> tuvimos en cuenta los retrasos en la notificación.
<code>EpiNow2</code> también podemos tener en cuenta las observaciones
incompletas, ya que, en realidad, el 100% de los casos no se notifican.
Pasaremos otro argumento a <code>epinow()</code> función llamada
<code>obs</code> para definir un modelo de observación. El formato de
<code>obs</code> se define mediante la función <code>obs_opt()</code>
(véase <code>?EpiNow2::obs_opts</code> para más detalles).</p>
<p>Supongamos que creemos que los datos del brote COVID-19 del
<code>cases</code> objeto no incluyen todos los casos notificados.
Creemos que sólo observamos el 40% de los casos. Para especificar esto
en el modelo de observación, debemos pasar un factor de escala con una
media y una desviación típica. Si suponemos que el 40% de los casos
están en los datos de casos (con una desviación típica del 1%), entonces
especificamos el factor <code>scale</code> de entrada a
<code>obs_opts()</code> como sigue:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obs_scale</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu">list</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.4</span>, sd <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></code></pre>
</div>
<p>Para ejecutar el marco de inferencia con este proceso de observación,
añadimos <code>obs = obs_opts(scale = obs_scale)</code> a los argumentos
de entrada de <code>epinow()</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define observation model</span></span>
<span><span class="va">obs_scale</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu">list</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.4</span>, sd <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assume we only have the first 90 days of this data</span></span>
<span><span class="va">reported_cases</span> <span class="op">&lt;-</span> <span class="va">cases</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">90</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimate and forecast</span></span>
<span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">epinow</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">reported_cases</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">generation_time_fixed</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">delay_opts</span><span class="op">(</span><span class="va">incubation_period_fixed</span> <span class="op">+</span> <span class="va">reporting_delay_fixed</span><span class="op">)</span>,</span>
<span>  rt <span class="op">=</span> <span class="va">rt_prior</span>,</span>
<span>  <span class="co"># Add observation model</span></span>
<span>  obs <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">obs_opts</span><span class="op">(</span>scale <span class="op">=</span> <span class="va">obs_scale</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>WARN [2024-10-22 02:52:02] epinow: There were 2 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them. -
WARN [2024-10-22 02:52:02] epinow: Examine the pairs() plot to diagnose sampling problems
 - </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">base</span><span class="fu">::</span><span class="fu">summary</span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                            measure              estimate
                             &lt;char&gt;                &lt;char&gt;
1:           New infections per day 17128 (9048 -- 31388)
2: Expected change in daily reports     Likely decreasing
3:       Effective reproduction no.    0.88 (0.59 -- 1.3)
4:                   Rate of growth -0.042 (-0.18 -- 0.1)
5:     Doubling/halving time (days)     -16 (6.7 -- -3.8)</code></pre>
</div>
<p>Las estimaciones de las medidas de transmisión, como el número de
reproducción efectivo y la tasa de crecimiento, son similares (o tienen
el mismo valor) que cuando no tuvimos en cuenta las observaciones
incompletas (ver <a href="quantify-transmissibility.html">cuantificar el
episodio de trans</a> en la sección “Encontrar estimaciones”). Sin
embargo, el número de nuevos casos confirmados por fecha de infección ha
cambiado sustancialmente de magnitud para reflejar la suposición de que
sólo el 40% de los casos están en el conjunto de datos.</p>
<p>También podemos cambiar la distribución por defecto de Binomial
Negativa a Poisson, eliminar el efecto de semana por defecto y más.
Consulta <code>?EpiNow2::obs_opts</code> para más detalles.</p>
</div>
<div class="section level3 debate">
<h3 id="cuáles-son-las-implicaciones-de-este-cambio">¿Cuáles son las implicaciones de este cambio?<a class="anchor" aria-label="anchor" href="#cu%C3%A1les-son-las-implicaciones-de-este-cambio"></a></h3>
<ul><li>Comparar diferentes porcentajes de observaciones %</li>
<li>¿En qué se diferencian en el número de infecciones estimadas?</li>
<li>¿Qué implicaciones tiene este cambio para la salud pública?</li>
</ul></div>
</section><section><h2 class="section-heading" id="previsión-de-observaciones-secundarias">Previsión de observaciones secundarias<a class="anchor" aria-label="anchor" href="#previsi%C3%B3n-de-observaciones-secundarias"></a></h2>
<hr class="half-width"><p><code>EpiNow2</code> también tiene la capacidad de estimar y
pronosticar observaciones secundarias, por ejemplo, muertes y
hospitalizaciones, a partir de una observación primaria, por ejemplo,
casos. Aquí ilustraremos cómo prever el número de muertes derivadas de
los casos observados de COVID-19 en las primeras fases del brote del
Reino Unido.</p>
<p>En primer lugar, debemos formatear nuestros datos para que tengan las
siguientes columnas:</p>
<ul><li>
<code>date</code>: la fecha (como objeto de fecha ver
<code>?is.Date()</code>),</li>
<li>
<code>primary</code>: número de observaciones primarias en esa
fecha, en este ejemplo <strong>casos</strong>,</li>
<li>
<code>secondary</code>: número de observaciones secundarias fecha,
en este ejemplo <strong>defunciones</strong>.</li>
</ul><div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reported_cases_deaths</span> <span class="op">&lt;-</span> <span class="fu">incidence2</span><span class="fu">::</span><span class="va">covidregionaldataUK</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># use {tidyr} to preprocess missing values</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu">replace_na</span><span class="op">(</span><span class="fu">base</span><span class="fu">::</span><span class="fu">list</span><span class="op">(</span>cases_new <span class="op">=</span> <span class="fl">0</span>, deaths_new <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># use {incidence2} to compute the daily incidence</span></span>
<span>  <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">incidence</span><span class="op">(</span></span>
<span>    date_index <span class="op">=</span> <span class="st">"date"</span>,</span>
<span>    counts <span class="op">=</span> <span class="fu">c</span><span class="op">(</span>primary <span class="op">=</span> <span class="st">"cases_new"</span>, secondary <span class="op">=</span> <span class="st">"deaths_new"</span><span class="op">)</span>,</span>
<span>    date_names_to <span class="op">=</span> <span class="st">"date"</span>,</span>
<span>    complete_dates <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># rearrange to wide format for {EpiNow2}</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">count_variable</span>, values_from <span class="op">=</span> <span class="va">count</span><span class="op">)</span></span></code></pre>
</div>
<figure style="text-align: center"><img src="../fig/create-forecast-rendered-unnamed-chunk-8-1.png" alt="Distribution of secondary cases (deaths). We will drop the first 30 days with no observed deaths. We will use the deaths between day 31 and day 60 to estimate the secondary observations. We will forecast deaths from day 61 to day 90." class="figure mx-auto d-block"><figcaption>
Distribution of secondary cases (deaths). We will drop the first 30 days
with no observed deaths. We will use the deaths between day 31 and day
60 to estimate the secondary observations. We will forecast deaths from
day 61 to day 90.
</figcaption></figure><p>Utilizando los datos sobre casos y muertes entre el día 31 y el día
60, estimaremos la relación entre las observaciones primarias y
secundarias utilizando <code>estimate_secondary()</code> y, a
continuación, pronosticaremos las muertes futuras mediante
<code>forecast_secondary()</code>. Para más detalles sobre el modelo,
consulta el <a href="https://epiforecasts.io/EpiNow2/dev/articles/estimate_secondary.html" class="external-link">documentación
del</a>.</p>
<p>Debemos especificar el tipo de observación mediante <code>type</code>
en <code>secondary_opts()</code>, las opciones incluyen:</p>
<ul><li>“incidencia”: las observaciones secundarias surgen de las
observaciones primarias previas, es decir, de las muertes que surgen de
los casos registrados.</li>
<li>“Prevalencia”: las observaciones secundarias surgen de una
combinación de observaciones primarias actuales y observaciones
secundarias anteriores, es decir, el uso de camas hospitalarias que
surge de los ingresos hospitalarios actuales y del uso de camas
hospitalarias anteriores.</li>
</ul><p>En este ejemplo especificamos
<code>secondary_opts(type = "incidence")</code>. Consulta
<code>?EpiNow2::secondary_opts</code> para más detalles.</p>
<p>La última entrada clave es la distribución del retraso entre las
observaciones primaria y secundaria. Aquí se trata del retraso entre la
notificación del caso y la muerte, suponemos que sigue una distribución
gamma con una media de 14 días y una desviación típica de 5 días
(Alternativamente, podemos utilizar <code>{epiparameter}</code> para <a href="https://epiverse-trace.github.io/tutorials-early/delays-reuse.html" class="external-link">acceder
a los retrasos epidemiológicos</a>). Utilizando <code>Gamma()</code>
especificamos una distribución gamma fija.</p>
<p>Hay más entradas de función para <code>estimate_secondary()</code>
que se pueden especificar, incluida la adición de un proceso de
observación, véase <code>?EpiNow2::estimate_secondary</code> para más
detalles sobre estas opciones.</p>
<p>Encontrar el ajuste del modelo entre casos y muertes:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate from day 31 to day 60 of this data</span></span>
<span><span class="va">cases_to_estimate</span> <span class="op">&lt;-</span> <span class="va">reported_cases_deaths</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">slice</span><span class="op">(</span><span class="fl">31</span><span class="op">:</span><span class="fl">60</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Delay distribution between case report and deaths</span></span>
<span><span class="va">delay_report_to_death</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">Gamma</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">Normal</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">14</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  sd <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">Normal</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">30</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimate secondary cases</span></span>
<span><span class="va">estimate_cases_to_deaths</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">estimate_secondary</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">cases_to_estimate</span>,</span>
<span>  secondary <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">secondary_opts</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"incidence"</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">delay_opts</span><span class="op">(</span><span class="va">delay_report_to_death</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>WARN [2024-10-22 02:52:09] estimate_secondary (chain: 1): Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.
Running the chains for more iterations may help. See
https://mc-stan.org/misc/warnings.html#bulk-ess - </code></pre>
</div>
<div id="ten-cuidado-con-la-escala-de-tiempo" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="ten-cuidado-con-la-escala-de-tiempo" class="callout-inner">
<h3 class="callout-title">Ten cuidado con la escala de tiempo</h3>
<div class="callout-content">
<p>En las primeras fases de un brote puede haber cambios sustanciales en
las pruebas y la notificación. Si hay cambios en las pruebas de un mes a
otro, habrá un sesgo en el ajuste del modelo. Por tanto, debes tener
cuidado con la escala temporal de los datos utilizados en el ajuste y la
previsión del modelo.</p>
</div>
</div>
</div>
<p>Trazamos el ajuste del modelo (cintas sombreadas) con las
observaciones secundarias (diagrama de barras) y las observaciones
primarias (línea de puntos) de la siguiente manera:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">estimate_cases_to_deaths</span>, primary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/create-forecast-rendered-unnamed-chunk-10-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Para utilizar este ajuste del modelo para pronosticar las muertes,
pasamos un marco de datos consistente en la observación primaria (casos)
para las fechas no utilizadas en el ajuste del modelo.</p>
<p><em>Nota : en este episodio estamos utilizando datos en los que
conocemos las muertes y los casos, por lo que creamos un marco de datos
extrayendo los casos. Pero, en la práctica, se trataría de otro conjunto
de datos formado sólo por los casos.</em></p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Forecast from day 61 to day 90</span></span>
<span><span class="va">cases_to_forecast</span> <span class="op">&lt;-</span> <span class="va">reported_cases_deaths</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">slice</span><span class="op">(</span><span class="fl">61</span><span class="op">:</span><span class="fl">90</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">mutate</span><span class="op">(</span>value <span class="op">=</span> <span class="va">primary</span><span class="op">)</span></span></code></pre>
</div>
<p>Para pronosticar, utilizamos el ajuste del modelo
<code>estimate_cases_to_deaths</code>:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Forecast secondary cases</span></span>
<span><span class="va">deaths_forecast</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">forecast_secondary</span><span class="op">(</span></span>
<span>  estimate <span class="op">=</span> <span class="va">estimate_cases_to_deaths</span>,</span>
<span>  primary <span class="op">=</span> <span class="va">cases_to_forecast</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">deaths_forecast</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/create-forecast-rendered-unnamed-chunk-12-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>
  haz una trama de previsión
  </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" aria-labelledby="headingSpoiler1" data-bs-parent="#accordionSpoiler1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deaths_forecast</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu">pluck</span><span class="op">(</span><span class="st">"predictions"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">secondary</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="st">"grey"</span>, col <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lower_90</span>, ymax <span class="op">=</span> <span class="va">upper_90</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.2</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lower_50</span>, ymax <span class="op">=</span> <span class="va">upper_50</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.4</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lower_20</span>, ymax <span class="op">=</span> <span class="va">upper_20</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.6</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Reports per day"</span>, x <span class="op">=</span> <span class="st">"Date"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_date</span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"week"</span>, date_labels <span class="op">=</span> <span class="st">"%b %d"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va">comma</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/create-forecast-rendered-unnamed-chunk-13-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
<p>El gráfico muestra la previsión de observaciones secundarias
(defunciones) en las fechas para las que hemos registrado casos. También
es posible prever las defunciones mediante la previsión de casos, para
lo que debes especificar <code>primary</code> como
<code>estimates</code> salida de <code>estimate_infections()</code>.</p>
<div id="intervalos-creíbles" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="intervalos-creíbles" class="callout-inner">
<h3 class="callout-title">Intervalos creíbles</h3>
<div class="callout-content">
<p>En todos <a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a> figuras de resultados, las regiones
sombreadas reflejan los intervalos de credibilidad del 90%, 50% y 20% en
orden de más claro a más oscuro.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="reto-análisis-del-brote-de-ébola">Reto: Análisis del brote de ébola<a class="anchor" aria-label="anchor" href="#reto-an%C3%A1lisis-del-brote-de-%C3%A9bola"></a></h2>
<hr class="half-width"><div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Desafío</h3>
<div class="callout-content">
<p>Descarga el archivo <a href="../data/ebola_cases.csv">casos_ébola.csv</a> y léelo en R. Los datos
simulados consisten en la fecha de aparición de los síntomas y el número
de casos confirmados de las primeras fases del brote de ébola en Sierra
Leona en 2014.</p>
<p>Utiliza los 3 primeros meses (120 días) de datos:</p>
<ol style="list-style-type: decimal"><li>Estima si los casos aumentan o disminuyen en el día 120 del
brote</li>
<li>Contar con una capacidad de observación del 80% de los casos.</li>
<li>Crea una previsión de dos semanas del número de casos.</li>
</ol><p>Puedes utilizar los siguientes valores de parámetro para la
distribución o distribuciones del retraso y la distribución del tiempo
de generación.</p>
<ul><li>Periodo de incubación: Log normal<span class="math inline">\((2.487,0.330)\)</span> (<a href="https://doi.org/10.1016/j.phrp.2011.04.001" class="external-link">Eichner et
al. 2011</a> a través de <code>{epiparameter}</code>)</li>
<li>Tiempo de generación: Gamma<span class="math inline">\((15.3,
10.1)\)</span> (<a href="https://www.nejm.org/doi/full/10.1056/NEJMoa1411100" class="external-link">Equipo de
respuesta al ébola de la OMS 2014</a>)</li>
</ul><p>Puedes incluir cierta incertidumbre en torno a la media y la
desviación típica de estas distribuciones.</p>
<div class="pista">
<p>Utilizamos el número de reproducción efectivo y la tasa de
crecimiento para estimar si los casos aumentan o disminuyen.</p>
<p>Podemos utilizar el <code>horizon</code> argumento dentro del
<code>epinow()</code> para ampliar el periodo de tiempo de la previsión.
El valor por defecto es de siete días.</p>
<p>Asegúrate de que los datos tienen el formato correcto :</p>
<ul><li>
<code>date</code>: la fecha (como objeto de fecha ver
<code>?is.Date()</code>),</li>
<li>
<code>confirm</code> número de casos confirmados en esa fecha.</li>
</ul></div>
<div class="section level3 solución">
<h3 id="solución">SOLUCIÓN<a class="anchor" aria-label="anchor" href="#soluci%C3%B3n"></a></h3>
<p>Para estimar el número efectivo de reproducción y la tasa de
crecimiento, utilizaremos la función <code>epinow()</code>.</p>
<p>Como los datos consisten en la fecha de aparición de los síntomas,
sólo necesitamos especificar una distribución de retardo para el periodo
de incubación y el tiempo de generación.</p>
<p>Especificamos las distribuciones con cierta incertidumbre en torno a
la media y la desviación típica de la distribución log normal para el
periodo de incubación y la distribución Gamma para el tiempo de
generación.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span>disease <span class="op">=</span> <span class="st">"ebola"</span>, epi_dist <span class="op">=</span> <span class="st">"incubation"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">parameter_tbl</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># Parameter table:
# A data frame:    5 × 7
  disease   pathogen epi_distribution prob_distribution author  year sample_size
  &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;             &lt;chr&gt;  &lt;dbl&gt;       &lt;dbl&gt;
1 Ebola Vi… Ebola V… incubation peri… lnorm             Eichn…  2011         196
2 Ebola Vi… Ebola V… incubation peri… gamma             WHO E…  2015        1798
3 Ebola Vi… Ebola V… incubation peri… gamma             WHO E…  2015          49
4 Ebola Vi… Ebola V… incubation peri… gamma             WHO E…  2015         957
5 Ebola Vi… Ebola V… incubation peri… gamma             WHO E…  2015         792</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ebola_eichner</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epidist_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_dist <span class="op">=</span> <span class="st">"incubation"</span>,</span>
<span>  author <span class="op">=</span> <span class="st">"Eichner"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ebola_eichner_parameters</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">get_parameters</span><span class="op">(</span><span class="va">ebola_eichner</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ebola_incubation_period</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">LogNormal</span><span class="op">(</span></span>
<span>  meanlog <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">Normal</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="va">ebola_eichner_parameters</span><span class="op">[</span><span class="st">"meanlog"</span><span class="op">]</span>,</span>
<span>    sd <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span>,</span>
<span>  sdlog <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">Normal</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="va">ebola_eichner_parameters</span><span class="op">[</span><span class="st">"sdlog"</span><span class="op">]</span>,</span>
<span>    sd <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">20</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ebola_generation_time</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">Gamma</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">Normal</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">15.3</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  sd <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">Normal</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">10.1</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">30</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Leemos los datos de entrada utilizando
<code>readr::read_csv()</code>. Esta función reconoce que la columna
<code>date</code> es una <code>&lt;date&gt;</code> vector de clase.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read data</span></span>
<span><span class="co"># e.g.: if path to file is data/raw-data/ebola_cases.csv then:</span></span>
<span><span class="va">ebola_cases_raw</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu">read_csv</span><span class="op">(</span></span>
<span>  <span class="fu">here</span><span class="fu">::</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"raw-data"</span>, <span class="st">"ebola_cases.csv"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Preprocesa y adapta los datos brutos para <a href="https://epiforecasts.io/EpiNow2/" class="external-link">EpiNow2</a>:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ebola_cases</span> <span class="op">&lt;-</span> <span class="va">ebola_cases_raw</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># use {tidyr} to preprocess missing values</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu">replace_na</span><span class="op">(</span><span class="fu">base</span><span class="fu">::</span><span class="fu">list</span><span class="op">(</span>confirm <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># use {incidence2} to compute the daily incidence</span></span>
<span>  <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">incidence</span><span class="op">(</span></span>
<span>    date_index <span class="op">=</span> <span class="st">"date"</span>,</span>
<span>    counts <span class="op">=</span> <span class="st">"confirm"</span>,</span>
<span>    count_values_to <span class="op">=</span> <span class="st">"confirm"</span>,</span>
<span>    date_names_to <span class="op">=</span> <span class="st">"date"</span>,</span>
<span>    complete_dates <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">count_variable</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu">as_tibble</span><span class="op">(</span><span class="va">ebola_cases</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 123 × 2
   date       confirm
   &lt;date&gt;       &lt;dbl&gt;
 1 2014-05-18       1
 2 2014-05-19       0
 3 2014-05-20       2
 4 2014-05-21       4
 5 2014-05-22       6
 6 2014-05-23       1
 7 2014-05-24       2
 8 2014-05-25       0
 9 2014-05-26      10
10 2014-05-27       8
# ℹ 113 more rows</code></pre>
</div>
<p>Definimos un modelo de observación para escalar el número estimado y
previsto de nuevas infecciones:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define observation model</span></span>
<span><span class="co"># mean of 80% and standard deviation of 1%</span></span>
<span><span class="va">ebola_obs_scale</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu">list</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.8</span>, sd <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></code></pre>
</div>
<p>Como queremos crear también una previsión a dos semanas,
especificamos <code>horizon = 14</code> para prever 14 días en lugar de
los 7 días por defecto.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ebola_estimates</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">epinow</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">ebola_cases</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">120</span><span class="op">)</span>, <span class="co"># first 3 months of data only</span></span>
<span>  generation_time <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">ebola_generation_time</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">delay_opts</span><span class="op">(</span><span class="va">ebola_incubation_period</span><span class="op">)</span>,</span>
<span>  <span class="co"># Add observation model</span></span>
<span>  obs <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">obs_opts</span><span class="op">(</span>scale <span class="op">=</span> <span class="va">ebola_obs_scale</span><span class="op">)</span>,</span>
<span>  <span class="co"># horizon needs to be 14 days to create two week forecast (default is 7 days)</span></span>
<span>  horizon <span class="op">=</span> <span class="fl">14</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>WARN [2024-10-22 02:54:32] epinow: There were 2 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them. -
WARN [2024-10-22 02:54:32] epinow: Examine the pairs() plot to diagnose sampling problems
 - </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">ebola_estimates</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">SALIDA<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                            measure              estimate
                             &lt;char&gt;                &lt;char&gt;
1:           New infections per day        82 (32 -- 204)
2: Expected change in daily reports     Likely increasing
3:       Effective reproduction no.     1.5 (0.78 -- 2.6)
4:                   Rate of growth 0.032 (-0.038 -- 0.1)
5:     Doubling/halving time (days)       22 (6.7 -- -18)</code></pre>
</div>
<p>El número de reproducción efectivo <span class="math inline">\(R_t\)</span> estimado (en la última fecha de los
datos) es 1.5 (0.78 – 2.6). La tasa de crecimiento exponencial del
número de casos es 0.032 (-0.038 – 0.1).</p>
<p>Visualiza las estimaciones:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">ebola_estimates</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="previsión-con-estimaciones-de-r_t" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="previsión-con-estimaciones-de-r_t" class="callout-inner">
<h3 class="callout-title">Previsión con estimaciones de <span class="math inline">\(R_t\)</span>
</h3>
<div class="callout-content">
<p>Por defecto, las previsiones a corto plazo se crean utilizando la
última estimación del número de reproducción <span class="math inline">\(R_t\)</span>. Como esta estimación se basa en
datos parciales, tiene una incertidumbre considerable.</p>
<p>El número de reproducciones que se proyecta en el futuro puede
cambiarse por una estimación menos reciente basada en más datos
utilizando <code>rt_opts()</code>:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">rt_opts</span><span class="op">(</span>future <span class="op">=</span> <span class="st">"estimate"</span><span class="op">)</span></span></code></pre>
</div>
<p>El resultado serán previsiones menos inciertas (ya que se basan en
<span class="math inline">\(R_t\)</span> con un intervalo de
incertidumbre más estrecho), pero las previsiones se basarán en
estimaciones menos recientes de <span class="math inline">\(R_t\)</span>
y supondrán que no ha habido cambios desde entonces.</p>
<p>Además, existe la opción de <a href="reference.html#projection">proyectar</a> el valor de <span class="math inline">\(R_t\)</span> en el futuro utilizando un modelo
genérico fijando <code>future = "project"</code>. Como esta opción
utiliza un modelo para prever el valor de <span class="math inline">\(R_t\)</span> el resultado serán previsiones más
inciertas que <code>estimate</code> por ejemplo <a href="https://epiforecasts.io/EpiNow2/dev/articles/estimate_infections_options.html#projecting-the-reproduction-number-with-the-gaussian-process" class="external-link">ver
aquí</a>.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="resumen">Resumen<a class="anchor" aria-label="anchor" href="#resumen"></a></h2>
<hr class="half-width"><p><code>EpiNow2</code> puede utilizarse para crear previsiones a corto
plazo y estimar la relación entre distintos resultados. Hay una serie de
opciones de modelo que pueden implementarse para diferentes análisis,
incluida la adición de un proceso de observación para tener en cuenta
los informes incompletos. Consulta la <a href="https://epiforecasts.io/EpiNow2/dev/articles/estimate_infections_options.html" class="external-link">viñeta</a>
para más detalles sobre las distintas opciones de modelo en
<code>EpiNow2</code> que no se tratan en estos tutoriales.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Puntos Clave</h3>
<div class="callout-content">
<ul><li>Podemos crear previsiones a corto plazo haciendo suposiciones sobre
el comportamiento futuro del número de reproducción</li>
<li>La notificación incompleta de casos puede tenerse en cuenta en las
estimaciones</li>
</ul></div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Capítulo previo y siguiente"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/delays-functions.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previo</a>
        <a class="chapter-link float-end" href="../instructor/severity-static.html">Siguiente<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/delays-functions.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previo: Utilizar
        </a>
        <a class="chapter-link float-end" href="../instructor/severity-static.html" rel="next">
          Siguiente: Estimación de la...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>Esta lección está sujeta al <a href="CODE_OF_CONDUCT.html">Código de Conducta</a></p>
        <p>

        <a href="https://github.com/epiverse-trace/tutorials-middle/edit/main/episodes/create-forecast.Rmd" class="external-link">Editar en GitHub</a>

	
        | <a href="https://github.com/epiverse-trace/tutorials-middle/blob/main/CONTRIBUTING.md" class="external-link">Contribuir</a>
        | <a href="https://github.com/epiverse-trace/tutorials-middle/" class="external-link">Fuente</a></p>
				<p><a href="https://github.com/epiverse-trace/tutorials-middle/blob/main/CITATION" class="external-link">Cita</a> | <a href="mailto:andree.valle-campos@lshtm.ac.uk">Contacto</a> | <a href="https://carpentries.org/about/" class="external-link">Acerca de</a></p>
			</div>
			<div class="col-md-6">

        <p>Materiales bajo la <a href="LICENSE.html">CC-BY 4.0</a> por las autoras</p>

        <p>Plantilla compartida bajo <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> por <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Construido con <a href="https://github.com/epiverse-trace/sandpaper/tree/patch-renv-github-bug" class="external-link">sandpaper (0.16.9)</a>, <a href="https://github.com/carpentries/pegboard/tree/main" class="external-link">pegboard (0.7.6)</a> y <a href="https://github.com/epiverse-trace/varnish/tree/epiversetheme" class="external-link">varnish (1.0.5.9000)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Volver al inicio"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Volver</span> al inicio
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://epiverse-trace.github.io/tutorials-middle/instructor/create-forecast.html",
  "inLanguage": "es",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "forecasts, epidemic models, interventions",
  "name": "Crear una previsión a corto plazo",
  "creativeWorkStatus": "active",
  "url": "https://epiverse-trace.github.io/tutorials-middle/instructor/create-forecast.html",
  "identifier": "https://epiverse-trace.github.io/tutorials-middle/instructor/create-forecast.html",
  "dateCreated": "2024-11-05",
  "dateModified": "2024-10-22",
  "datePublished": "2024-11-05"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

